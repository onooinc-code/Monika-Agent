<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monica - State Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./shared.css">
</head>
<body class="p-4 sm:p-6 lg:p-8">

    <header class="docs-header max-w-screen-xl mx-auto glass-pane rounded-xl p-3 px-4 flex justify-between items-center">
        <h1 class="header-title text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 via-cyan-400 to-indigo-400">
            <a href="./index.html">Monica Docs</a>
        </h1>
        <div class="header-buttons flex items-center gap-1">
            <button id="zoom-out-btn" title="Zoom Out" class="p-2 rounded-lg hover:bg-white/10 transition-colors"><i data-lucide="zoom-out"></i></button>
            <button id="zoom-in-btn" title="Zoom In" class="p-2 rounded-lg hover:bg-white/10 transition-colors"><i data-lucide="zoom-in"></i></button>
            <button id="text-dec-btn" title="Decrease Text Size" class="p-2 rounded-lg hover:bg-white/10 transition-colors"><i data-lucide="minus"></i></button>
            <button id="text-inc-btn" title="Increase Text Size" class="p-2 rounded-lg hover:bg-white/10 transition-colors"><i data-lucide="plus"></i></button>
            <button id="scroll-top-btn" title="Scroll to Top" class="p-2 rounded-lg hover:bg-white/10 transition-colors"><i data-lucide="arrow-up"></i></button>
            <button id="scroll-bottom-btn" title="Scroll to Bottom" class="p-2 rounded-lg hover:bg-white/10 transition-colors"><i data-lucide="arrow-down"></i></button>
            <button id="nav-toggle-btn" title="Navigation" class="p-2 rounded-lg hover:bg-white/10 transition-colors"><i data-lucide="menu"></i></button>
        </div>
    </header>

    <main class="docs-main max-w-screen-xl mx-auto glass-pane rounded-xl p-8 animate-fade-in-up" style="animation-delay: 0.2s;">
        <div class="prose prose-docs max-w-none">
            <h1>State Management</h1>
            <p class="lead">Monica uses a clean, hooks-based state management architecture built on React Context. This provides a scalable and maintainable way to manage application state without introducing external libraries.</p>

            <h3>The Core: <code>StateProvider.tsx</code></h3>
            <p>The entire state management system is orchestrated from <code>contexts/StateProvider.tsx</code>. This file serves as the central hub for the application's data and logic.</p>
            
            <h3>The Logic Domains: Custom Hooks</h3>
            <p>Instead of a single, monolithic state file, logic is segregated into custom hooks based on their domain of responsibility. This adheres to the Single Responsibility Principle and makes the codebase much easier to navigate and test.</p>

            <div class="space-y-4">
                <div class="glass-pane -m-2 p-3 rounded-lg">
                    <h4><code>useConversationManager</code></h4>
                    <p>Manages the lifecycle of conversations: creating, deleting, selecting, updating, and generating titles.</p>
                </div>
                <div class="glass-pane -m-2 p-3 rounded-lg">
                    <h4><code>useChatHandler</code></h4>
                    <p>Contains the core chat orchestration logic, managing loading states and determining the chat flow based on the current mode.</p>
                </div>
                <div class="glass-pane -m-2 p-3 rounded-lg">
                    <h4><code>useHistoryHandler</code></h4>
                    <p>Manages the logic for generating the structured conversation history view.</p>
                </div>
                <div class="glass-pane -m-2 p-3 rounded-lg">
                    <h4><code>useModalManager</code></h4>
                    <p>Centralizes the state for all modals and panels in the application.</p>
                </div>
                <div class="glass-pane -m-2 p-3 rounded-lg">
                    <h4><code>useUsageTracker</code></h4>
                    <p>Handles the client-side estimation and persistence of API usage metrics.</p>
                </div>
                <div class="glass-pane -m-2 p-3 rounded-lg">
                    <h4><code>useMemoryManager</code></h4>
                    <p>Manages the state and persistence of the AI's long-term memory.</p>
                </div>
            </div>

            <h3>Consuming State: <code>useAppContext</code></h3>
            <p>Components access the state and dispatch functions through a single, simple hook: <code>useAppContext()</code>. This hook provides access to the entire state object defined in the provider, abstracting away the underlying complexity.</p>
            <pre><code>import { useAppContext } from '../contexts/StateProvider.tsx';

const MyComponent = () => {
  const { activeConversation, handleNewConversation } = useAppContext();
  // ...
}
</code></pre>
        </div>
    </main>
    
    <div id="nav-modal-overlay"></div>
    <div id="nav-modal" class="w-full max-w-md glass-pane rounded-xl">
        <div class="p-4 border-b border-white/10 flex justify-between items-center">
            <h2 class="text-lg font-semibold text-white">Navigation</h2>
            <button id="nav-modal-close-btn" title="Close" class="p-2 rounded-lg hover:bg-white/10 transition-colors"><i data-lucide="x"></i></button>
        </div>
        <nav class="p-4">
             <ul class="space-y-2">
                <li><a href="./index.html" class="nav-link block p-3 rounded-lg border-l-4 border-transparent transition-all hover:bg-white/10">Home</a></li>
                <li><a href="./README.html" class="nav-link block p-3 rounded-lg border-l-4 border-transparent transition-all hover:bg-white/10">Project Overview</a></li>
                <li><a href="./architecture.html" class="nav-link block p-3 rounded-lg border-l-4 border-transparent transition-all hover:bg-white/10">Architecture Guide</a></li>
                <li><a href="./development_cycle.html" class="nav-link block p-3 rounded-lg border-l-4 border-transparent transition-all hover:bg-white/10">Development Cycle</a></li>
                <li><a href="./state_management.html" class="nav-link block p-3 rounded-lg border-l-4 border-transparent transition-all hover:bg-white/10">State Management</a></li>
                <li><a href="./services.html" class="nav-link block p-3 rounded-lg border-l-4 border-transparent transition-all hover:bg-white/10">Services & API</a></li>
                <li><a href="./components.html" class="nav-link block p-3 rounded-lg border-l-4 border-transparent transition-all hover:bg-white/10">Component Library</a></li>
                <li><a href="./styling_guide.html" class="nav-link block p-3 rounded-lg border-l-4 border-transparent transition-all hover:bg-white/10">Styling Guide</a></li>
                <li><a href="./database_migration_plan.html" class="nav-link block p-3 rounded-lg border-l-4 border-transparent transition-all hover:bg-white/10">Database Migration</a></li>
                <li><a href="./future_features_with_backend.html" class="nav-link block p-3 rounded-lg border-l-4 border-transparent transition-all hover:bg-white/10">Future Vision</a></li>
                <li><a href="./document_generator.html" class="nav-link block p-3 rounded-lg border-l-4 border-transparent transition-all hover:bg-white/10">AI Doc Generator</a></li>
            </ul>
        </nav>
    </div>

    <script>lucide.createIcons();</script>
    <script src="./shared.js"></script>
</body>
</html>